<head>
  <title>Swiss Ladder</title>
</head>

<body>
  <form class="addPlayer">
    <input type="text" name="playerName" placeholder="New player name">
  </form>
  <div>
    <button class="addSetup" type="button">Add Setup</button>
    {{#if setups.count}}
      Remove:
      {{#each setups}}
        <button class="removeSetup" type="button" value="{{_id}}">{{number}}</button>
      {{/each}}
    {{/if}}
  </div>
  <button class="clear" type="button">Clear DB</button>

  <div class="container">
    <div class="column">
      <h3>Playing</h3>
      <table class="withButtons">
        {{#each playing}}
          <tr>
            <td rowspan="2">{{setupNumber}}</td>
            <td>
              <label>
                <input type="radio" form="playing{{_id}}" name="winner" value="player1">
                {{player1Name}}
              </label>
            </td>
            <td rowspan="2">
              <form class="winPlayer" id="playing{{_id}}">
                <input type="hidden" name="pairingId" value="{{_id}}">
                <button type="submit">Submit</button>
              </form>
            </td>
          </tr>
          <tr>
            <td>
              <label>
                <input type="radio" form="playing{{_id}}" name="winner" value="player2">
                {{player2Name}}
              </label>
            </td>
          </tr>
          <tr></tr>
        {{/each}}
      </table>

      <h3>Waiting</h3>
      <table class="withButtons">
        {{#each waiting}}
          <tr>
            {{#if player1Id}}
              <td>
                <form class="dequeueWaiting" id="waiting{{player1Id}}">
                  <input type="hidden" name="pairingId" value="{{_id}}">
                  <input type="hidden" name="quitter" value="player1">
                  {{player1Name}}
                </form>
              </td>
              <td rowspan="2">{{score}}</td>
              <td><button type="submit" form="waiting{{player1Id}}">Dequeue</button></td>
            {{else}}
              <td>?</td>
            {{/if}}
          </tr>
          <tr>
            {{#if player2Id}}
              <td>
                <form class="dequeueWaiting" id="waiting{{player2Id}}">
                  <input type="hidden" name="pairingId" value="{{_id}}">
                  <input type="hidden" name="quitter" value="player2">
                  {{player2Name}}
                </form>
              </td>
              <td><button type="submit" form="waiting{{player2Id}}">Dequeue</button></td>
            {{else}}
              <td>?</td>
            {{/if}}
          </tr>
          <tr></tr>
        {{/each}}
      </table>

      <h3>Matchmaking</h3>
      <table class="withButtons">
        {{#each matchmaking}}
          <tr>
            <td>{{name}}</td>
            <td>{{score}}</td>
            <td>
              <button class="dequeueMatchmaking" type="button" value="{{_id}}">Dequeue</button>
            </td>
          </tr>
        {{/each}}
      </table>

      <h3>Unqueued</h3>
      <table class="withButtons">
        {{#each unqueued}}
          <tr>
            <td>{{name}}</td>
            <td>
              {{#if games}}
                <button type="button" disabled>x</button>
              {{else}}
                <button class="removePlayer" type="button" value="{{_id}}">x</button>
              {{/if}}
            </td>
            <td><button class="queuePlayer" type="button" value="{{_id}}">Queue</button></td>
          </tr>
        {{/each}}
      </table>
    </div>
    <div class="column">
      <h3>Standings</h3>
      <table class="standings">
        <thead>
          <tr><td>Name</td><td>Score</td><td>W</td><td>L</td></tr>
        </thead>
        <tbody>
          {{#each standings}}
            <tr>
              <td>{{name}}</td>
              <td>{{score}}</td>
              <td>{{wins}}</td>
              <td>{{losses}}</td>
            </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  </div>
</body>
